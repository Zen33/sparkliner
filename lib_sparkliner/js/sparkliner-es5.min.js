"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),sparkLiner=function(){function t(i,e,s,o){switch(_classCallCheck(this,t),this._root=i,this._data=e,this._dataLen=this._data.length,this._type=s,this._defaults={showTooltips:!0,barSpace:2,dotRadius:4,dotVerticalLine:!0,lineShowCursor:!0,histogramBarCount:5,histogramBarSpace:2,progressGradientStart:"red",progressGradientEnd:"rgb(120, 141, 255)",progressGradientLineOverflow:10,progressStepLineOverflow:10},this._options=Object.assign({},this._defaults,o),this._computedStyle=getComputedStyle(this._root),this._rootWidth=this._root.clientWidth-parseInt(this._computedStyle.paddingLeft)-parseInt(this._computedStyle.paddingRight),this._rootHeight=this._root.clientHeight-parseInt(this._computedStyle.paddingTop)-parseInt(this._computedStyle.paddingBottom),this._type){case"bars":this._renderBars();break;case"dots":this._renderDots();break;case"polygon":this._renderPolygon();break;case"histogram":this._renderHistogram();break;case"progressgradient":this._renderProgressGradient();break;case"progressstep":this._renderProgressStep();break;case"progresscircle":this._renderProgressCircle();break;default:alert("Invalid type of chart")}this._activateTooltip()}return _createClass(t,[{key:"_activateTooltip",value:function(){var t=this;this._options.showTooltips&&!document.getElementById("sparkliner__tooltip")?(this._tooltip=document.createElement("div"),this._tooltip.id="sparkliner__tooltip",document.body.appendChild(this._tooltip),document.body.addEventListener("mousemove",function(i){t._tooltip.style.left=i.clientX+15+"px",t._tooltip.style.top=i.clientY+15+window.pageYOffset+"px"})):this._tooltip=document.getElementById("sparkliner__tooltip")}},{key:"_calculateIntersection",value:function(t,i,e){var s=(i[1]-t[1])/e;return t[0]+Math.abs(t[1]/s)}},{key:"_positionToValue",value:function(t,i,e){for(var s=0;s<i.length-1;s++)if(t>=i[s][0]&&t<=i[s+1][0]){var o=t-i[s][0],a=(i[s+1][1]-i[s][1])/(i[s+1][0]-i[s][0]);return((i[s][1]+o*a)/e).toFixed(2)}}},{key:"_renderBars",value:function(){var t=this,i=this._options.barSpace,e=(this._rootWidth-i*(this._dataLen-1))/this._dataLen,s=Math.max.apply(null,this._data),o=Math.min.apply(null,this._data),a=0;o<0&&(s+=Math.abs(o),a=Math.abs(o)/s*this._rootHeight);for(var r="",n=0;n<this._dataLen;n++){var l=this._data[n]/s*this._rootHeight;r+="<path "+(this._data[n]>0?'class="sparkliner__bar"':'class="sparkliner__bar sparkliner__bar--underzero"')+' data-bar-value="'+this._data[n]+'" d="M'+n*(e+i)+" "+(this._rootHeight-a)+" L"+n*(e+i)+" "+(this._rootHeight-l-a)+" L"+(n*(e+i)+e)+" "+(this._rootHeight-l-a)+" L"+(n*(e+i)+e)+" "+(this._rootHeight-a)+' Z" />'}var h='<svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+r+"</svg>";this._root.innerHTML=h,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName){var s=e.getAttribute("data-bar-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderDots",value:function(){var t=this,i=this._rootWidth/this._dataLen,e=Math.max.apply(null,this._data),s=this._options.dotRadius,o=Math.min.apply(null,this._data),a=0;o<0&&(e+=Math.abs(o),a=Math.abs(o)/e*this._rootHeight);for(var r="",n=0;n<this._dataLen;n++){var l=this._data[n]/e*this._rootHeight-s;l=l>0?l:l+2*s,r+='<g data-dot-value="'+this._data[n]+'">\n                <circle '+(this._data[n]>0?'class="sparkliner__dot"':'class="sparkliner__dot sparkliner__dot--underzero"')+' cx="'+(n*i+i/2)+'" cy="'+(this._rootHeight-l-a)+'" r="'+s+'" />\n                '+(this._options.dotVerticalLine?"<line "+(this._data[n]>0?'class="sparkliner__dotline"':'class="sparkliner__dotline sparkliner__dotline--underzero"')+' class="sparkliner__dotline" x1="'+(n*i+i/2)+'" y1="'+(this._rootHeight-l-a)+'" x2="'+(n*i+i/2)+'" y2="'+(this._rootHeight-a)+'" />':"")+"\n                </g>"}var h='<svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+r+" "+(o<0?'<line class="sparkliner__horizontal-axe" x1="0" y1="'+(this._rootHeight-a)+'" x2="'+this._rootWidth+'" y2="'+(this._rootHeight-a)+'" />':"")+"</svg>";this._root.innerHTML=h,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("circle"!=e.tagName&&"line"!=e.tagName||"g"!=e.parentElement.tagName)t._tooltip.style.visibility="hidden";else{var s=e.parentElement.getAttribute("data-dot-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderPolygon",value:function(){var t=this,i=this._rootWidth/(this._dataLen-1),e=Math.max.apply(null,this._data),s=Math.min.apply(null,this._data),o=0;s<0&&(e+=Math.abs(s),o=Math.abs(s)/e*this._rootHeight);for(var a=this._rootHeight/e,r=this._data.map(function(s,o){return[o*i,s/e*t._rootHeight]}),n=[[0,0]],l=0;l<r.length;l++)r[l+1]?r[l][1]<0&&r[l+1][1]>0?(n.push(r[l]),n.push([this._calculateIntersection(r[l],r[l+1],i),0])):r[l][1]>0&&r[l+1][1]<0?(n.push(r[l]),n.push([this._calculateIntersection(r[l],r[l+1],i),0])):n.push(r[l]):n.push(r[l]);n.push([this._rootWidth,0]);for(var h=[],_=[],d=[],p=0;p<n.length;p++)0==p?d.push(n[p].join(",")):p==n.length?(d.push(n[p].join(",")),n[p][1]>0?h.push(d):n[p][1]<0?_.push(d):n[p-1][1]>0?h.push(d):n[p-1][1]<0&&_.push(d)):0==n[p][1]?(d.push(n[p].join(",")),n[p-1][1]>0?h.push(d):_.push(d),(d=[]).push(n[p].join(","))):d.push(n[p].join(","));h=h.map(function(i){return(i=i.map(function(i){return[i.split(",")[0],t._rootHeight-o-i.split(",")[1]].join(",")})).join(" ")}),_=_.map(function(i){return(i=i.map(function(i){return[i.split(",")[0],t._rootHeight-o-i.split(",")[1]].join(",")})).join(" ")});var v="",u="",g=!0,c=!1,y=void 0;try{for(var m,f=h[Symbol.iterator]();!(g=(m=f.next()).done);g=!0)v+='<polygon class="sparkliner__polygon-positive" points="'+m.value+'" />'}catch(t){c=!0,y=t}finally{try{!g&&f.return&&f.return()}finally{if(c)throw y}}var b=!0,k=!1,L=void 0;try{for(var x,H=_[Symbol.iterator]();!(b=(x=H.next()).done);b=!0)u+='<polygon class="sparkliner__polygon-negative" points="'+x.value+'" />'}catch(t){k=!0,L=t}finally{try{!b&&H.return&&H.return()}finally{if(k)throw L}}var w='\n            <svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">\n                '+v+"\n                "+u+"\n                "+(this._options.lineShowCursor?'<line class="sparkliner__polygon-cursor" x1="0" y1="'+this._rootHeight+'" x2="0" y2="0" />':"")+"\n            </svg>\n        ";if(this._root.innerHTML=w,this._options.showTooltips){var M=this._root.firstElementChild.lastElementChild;this._root.firstElementChild.addEventListener("mousemove",function(i){var e=t._root.getBoundingClientRect().left,s=t._root.clientLeft,o=parseInt(getComputedStyle(t._root,null).getPropertyValue("padding-left")),n=i.pageX-e-s-o,l=t._positionToValue(n,r,a);t._tooltip.innerText=l,void 0!==l?(t._tooltip.style.visibility="visible",t._options.lineShowCursor&&(M.style.visibility="visible")):(t._tooltip.style.visibility="hidden",t._options.lineShowCursor&&(M.style.visibility="hidden")),t._options.lineShowCursor&&(M.setAttribute("x1",""+n),M.setAttribute("x2",""+n))}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden",M.style.visibility="hidden"})}}},{key:"_renderHistogram",value:function(){for(var t=this,i=this._options.histogramBarSpace,e=(this._rootWidth-i*(this._options.histogramBarCount-1))/this._options.histogramBarCount,s=Math.min.apply(null,this._data),o=(Math.max.apply(null,this._data)-Math.min.apply(null,this._data))/this._options.histogramBarCount,a=[],r=0;r<this._options.histogramBarCount;r++)!function(i){var e=i*o+s,r=e+o,n=t._data.filter(function(t){return t>=e&&t<=r}).length;a.push(n)}(r);for(var n=this._rootHeight/Math.max.apply(null,a),l="",r=0;r<this._options.histogramBarCount;r++){var h=a[r]*n;l+='<path class="sparkliner__histogram-bar" data-bar-value="('+(s+r*o).toFixed(1)+"-"+(o+s+r*o).toFixed(1)+"):"+a[r]+'" d="\n                M'+r*(e+i)+" "+this._rootHeight+" \n                L"+r*(e+i)+" "+(this._rootHeight-h)+" \n                L"+(r*(e+i)+e)+" "+(this._rootHeight-h)+" \n                L"+(r*(e+i)+e)+" "+this._rootHeight+' \n            Z" />'}var _='<svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+l+"</svg>";this._root.innerHTML=_,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName){var s=e.getAttribute("data-bar-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderProgressGradient",value:function(){var t=this,i=void 0,e=void 0;!Array.isArray(this._data)&&this._data<=100?(i=this._data,e=100):Array.isArray(this._data)&&2===this._dataLen&&this._data[0]<this._data[1]&&(i=this._data[0],e=this._data[1]);var s=i/e*this._rootWidth,o='\n        <line class="sparkliner__progressgradient-line" data-progress-value="'+i+" / "+e+'" x1="'+s+'" y1="'+(this._rootHeight+this._options.progressGradientLineOverflow)+'" x2="'+s+'" y2="'+-this._options.progressGradientLineOverflow+'" />\n        <text class="sparkliner__progressgradient-text" data-progress-value="'+i+" / "+e+'" x="'+this._rootWidth/2+'" y="'+this._rootHeight/2+'" text-anchor="middle" alignment-baseline="middle" dominant-baseline="middle" >'+(i/e*100).toFixed(2)+"%</text>\n        ",a='<svg class="sparkliner sparkliner__progressgradient" data-progress-value="'+i+" / "+e+'" style="overflow:visible" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+o+"</svg>";this._root.innerHTML=a,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("svg"==e.tagName||"line"==e.tagName||"text"==e.tagName){var s=e.getAttribute("data-progress-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderProgressStep",value:function(){var t=this,i=void 0,e=void 0;!Array.isArray(this._data)&&this._data<=100?(i=this._data,e=100):Array.isArray(this._data)&&2===this._dataLen&&this._data[0]<this._data[1]&&(i=this._data[0],e=this._data[1]);var s=i/e*this._rootWidth,o='\n            <path class="sparkliner__progressstep-complete" data-progress-value="'+i+" / "+e+'" d="M0 0 L0 '+this._rootHeight+" L"+s+" "+this._rootHeight+" L"+s+' 0 Z" />\n            <path class="sparkliner__progressstep-incomplete" data-progress-value="'+i+" / "+e+'" d="M'+s+" 0 L"+s+" "+this._rootHeight+" L"+this._rootWidth+" "+this._rootHeight+" L"+this._rootWidth+' 0 Z" />\n            <line class="sparkliner__progressstep-line" data-progress-value="'+i+" / "+e+'" x1="'+s+'" y1="'+(this._rootHeight+this._options.progressStepLineOverflow)+'" x2="'+s+'" y2="'+-this._options.progressStepLineOverflow+'" />\n            <text class="sparkliner__progressstep-text" data-progress-value="'+i+" / "+e+'" x="'+this._rootWidth/2+'" y="'+this._rootHeight/2+'" text-anchor="middle" alignment-baseline="middle" dominant-baseline="middle" >'+(100*i/e).toFixed(2)+"%</text>\n        ",a='<svg class="sparkliner" style="overflow:visible" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+o+"</svg>";this._root.innerHTML=a,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName||"line"==e.tagName||"text"==e.tagName){var s=e.getAttribute("data-progress-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderProgressCircle",value:function(){var t=this,i=this._rootHeight/2,e=void 0,s=void 0;!Array.isArray(this._data)&&this._data<=100?(e=100==this._data?e=99.9999:this._data,s=100):Array.isArray(this._data)&&2===this._dataLen&&this._data[0]<=this._data[1]&&(e=100==this._data[0]?e=99.9999:this._data[0],s=this._data[1]);var o=e/s*2*Math.PI,a=this._rootWidth/2+i,r=this._rootHeight/2,n=a+i*Math.cos(Math.PI/2-o),l=r+i*-Math.sin(Math.PI/2-o),h='\n            <text class="sparkliner__circle-text" data-circle-value="'+e+" / "+s+'" x="'+(this._rootWidth/2-3)+'" y="'+this._rootHeight/2+'" text-anchor="end" alignment-baseline="middle" dominant-baseline="middle">\n                '+(100*e/s).toFixed(1)+'%\n            </text>\n            <circle class="sparkliner__circle-incomplete" data-circle-value="'+e+" / "+s+'" cx="'+a+'" cy="'+r+'" r="'+i+'"/>\n            <path class="sparkliner__circle-complete" data-circle-value="'+e+" / "+s+'" \n                d="M'+a+",0\n                A"+i+","+i+" 0 "+(o<=Math.PI?"0,1":"1,1")+" "+n+","+l+" \n                L"+a+","+r+' \n                Z" \n            />\n        ',_='<svg class="sparkliner" style="overflow:visible" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+h+"</svg>";this._root.innerHTML=_,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName||"circle"==e.tagName||"text"==e.tagName){var s=e.getAttribute("data-circle-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}}]),t}();