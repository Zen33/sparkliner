"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),sparkLiner=function(){function t(i,e,s,o){switch(_classCallCheck(this,t),this._root=i,this._data=e,this._dataLen=this._data.length,this._type=s,this._defaults={showTooltips:!0,barSpace:2,dotRadius:4,dotVerticalLine:!0,lineShowCursor:!0,histogramBarCount:5,histogramBarSpace:2,progressGradientStart:"red",progressGradientEnd:"rgb(120, 141, 255)",progressGradientLineOverflow:10,progressStepLineOverflow:10},this._options=Object.assign({},this._defaults,o),this._computedStyle=getComputedStyle(this._root),this._rootWidth=this._root.clientWidth-parseInt(this._computedStyle.paddingLeft)-parseInt(this._computedStyle.paddingRight),this._rootHeight=this._root.clientHeight-parseInt(this._computedStyle.paddingTop)-parseInt(this._computedStyle.paddingBottom),this._type){case"bars":this._renderBars();break;case"dots":this._renderDots();break;case"polygon":this._renderPolygon();break;case"histogram":this._renderHistogram();break;case"progressgradient":this._renderProgressGradient();break;case"progressstep":this._renderProgressStep();break;case"progresscircle":this._renderProgressCircle();break;default:alert("Invalid type of chart")}this._activateTooltip()}return _createClass(t,[{key:"_activateTooltip",value:function(){var t=this;this._options.showTooltips&&!document.getElementById("sparkliner__tooltip")?(this._tooltip=document.createElement("div"),this._tooltip.id="sparkliner__tooltip",document.body.appendChild(this._tooltip),document.body.addEventListener("mousemove",function(i){t._tooltip.style.left=i.clientX+15+"px",t._tooltip.style.top=i.clientY+15+window.pageYOffset+"px"})):this._tooltip=document.getElementById("sparkliner__tooltip")}},{key:"_calculateIntersection",value:function(t,i,e){var s=(i[1]-t[1])/e;return t[0]+Math.abs(t[1]/s)}},{key:"_positionToValue",value:function(t,i,e){for(var s=0;s<i.length-1;s++)if(t>=i[s][0]&&t<=i[s+1][0]){var o=t-i[s][0],r=(i[s+1][1]-i[s][1])/(i[s+1][0]-i[s][0]);return((i[s][1]+o*r)/e).toFixed(2)}}},{key:"_renderBars",value:function(){var t=this,i=this._options.barSpace,e=(this._rootWidth-i*(this._dataLen-1))/this._dataLen,s=Math.max.apply(null,this._data),o=Math.min.apply(null,this._data),r=0;o<0&&(s+=Math.abs(o),r=Math.abs(o)/s*this._rootHeight);for(var a="",n=0;n<this._dataLen;n++){var l=this._data[n]/s*this._rootHeight;a+="<path "+(this._data[n]>0?'class="sparkliner__bar"':'class="sparkliner__bar sparkliner__bar--underzero"')+' data-bar-value="'+this._data[n]+'" d="M'+n*(e+i)+" "+(this._rootHeight-r)+" L"+n*(e+i)+" "+(this._rootHeight-l-r)+" L"+(n*(e+i)+e)+" "+(this._rootHeight-l-r)+" L"+(n*(e+i)+e)+" "+(this._rootHeight-r)+' Z" />'}var h='<svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+a+"</svg>";this._root.innerHTML=h,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName){var s=e.getAttribute("data-bar-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderDots",value:function(){var t=this,i=this._rootWidth/this._dataLen,e=Math.max.apply(null,this._data),s=this._options.dotRadius,o=Math.min.apply(null,this._data),r=0;o<0&&(e+=Math.abs(o),r=Math.abs(o)/e*this._rootHeight);for(var a="",n=0;n<this._dataLen;n++){var l=this._data[n]/e*this._rootHeight-s;l=l>0?l:l+2*s,a+='<g data-dot-value="'+this._data[n]+'">\n                <circle '+(this._data[n]>0?'class="sparkliner__dot"':'class="sparkliner__dot sparkliner__dot--underzero"')+' cx="'+(n*i+i/2)+'" cy="'+(this._rootHeight-l-r)+'" r="'+s+'" />\n                '+(this._options.dotVerticalLine?"<line "+(this._data[n]>0?'class="sparkliner__dotline"':'class="sparkliner__dotline sparkliner__dotline--underzero"')+' class="sparkliner__dotline" x1="'+(n*i+i/2)+'" y1="'+(this._rootHeight-l-r)+'" x2="'+(n*i+i/2)+'" y2="'+(this._rootHeight-r)+'" />':"")+"\n                </g>"}var h='<svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+a+" "+(o<0?'<line class="sparkliner__horizontal-axe" x1="0" y1="'+(this._rootHeight-r)+'" x2="'+this._rootWidth+'" y2="'+(this._rootHeight-r)+'" />':"")+"</svg>";this._root.innerHTML=h,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("circle"!=e.tagName&&"line"!=e.tagName||"g"!=e.parentElement.tagName)t._tooltip.style.visibility="hidden";else{var s=e.parentElement.getAttribute("data-dot-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderPolygon",value:function(){var t=this,i=this._rootWidth/(this._dataLen-1),e=Math.max.apply(null,this._data),s=Math.min.apply(null,this._data),o=0;s<0&&(e+=Math.abs(s),o=Math.abs(s)/e*this._rootHeight);for(var r=this._rootHeight/e,a=this._data.map(function(s,o){return[o*i,s/e*t._rootHeight]}),n=[[0,0]],l=0;l<a.length;l++)a[l+1]?a[l][1]<0&&a[l+1][1]>0?(n.push(a[l]),n.push([this._calculateIntersection(a[l],a[l+1],i),0])):a[l][1]>0&&a[l+1][1]<0?(n.push(a[l]),n.push([this._calculateIntersection(a[l],a[l+1],i),0])):n.push(a[l]):n.push(a[l]);n.push([this._rootWidth,0]);for(var h=[],d=[],_=[],p=0;p<n.length;p++)0==p?_.push(n[p].join(",")):p==n.length?(_.push(n[p].join(",")),n[p][1]>0?h.push(_):n[p][1]<0?d.push(_):n[p-1][1]>0?h.push(_):n[p-1][1]<0&&d.push(_)):0==n[p][1]?(_.push(n[p].join(",")),n[p-1][1]>0?h.push(_):d.push(_),(_=[]).push(n[p].join(","))):_.push(n[p].join(","));h=h.map(function(i){return(i=i.map(function(i){return[i.split(",")[0],t._rootHeight-o-i.split(",")[1]].join(",")})).join(" ")}),d=d.map(function(i){return(i=i.map(function(i){return[i.split(",")[0],t._rootHeight-o-i.split(",")[1]].join(",")})).join(" ")});var g="",v="",u=!0,c=!1,y=void 0;try{for(var m,f=h[Symbol.iterator]();!(u=(m=f.next()).done);u=!0)g+='<polygon class="sparkliner__polygon-positive" points="'+m.value+'" />'}catch(t){c=!0,y=t}finally{try{!u&&f.return&&f.return()}finally{if(c)throw y}}var b=!0,k=!1,L=void 0;try{for(var x,H=d[Symbol.iterator]();!(b=(x=H.next()).done);b=!0)v+='<polygon class="sparkliner__polygon-negative" points="'+x.value+'" />'}catch(t){k=!0,L=t}finally{try{!b&&H.return&&H.return()}finally{if(k)throw L}}var w='\n            <svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">\n                '+g+"\n                "+v+"\n                "+(this._options.lineShowCursor?'<line class="sparkliner__polygon-cursor" x1="0" y1="'+this._rootHeight+'" x2="0" y2="0" />':"")+"\n            </svg>\n        ";if(this._root.innerHTML=w,this._options.showTooltips){var B=this._root.firstElementChild.lastElementChild;this._root.firstElementChild.addEventListener("mousemove",function(i){var e=t._root.getBoundingClientRect().left,s=t._root.clientLeft,o=parseInt(getComputedStyle(t._root,null).getPropertyValue("padding-left")),n=i.pageX-e-s-o,l=t._positionToValue(n,a,r);t._tooltip.innerText=l,void 0!==l?(t._tooltip.style.visibility="visible",t._options.lineShowCursor&&(B.style.visibility="visible")):(t._tooltip.style.visibility="hidden",t._options.lineShowCursor&&(B.style.visibility="hidden")),t._options.lineShowCursor&&(B.setAttribute("x1",""+n),B.setAttribute("x2",""+n))}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden",B.style.visibility="hidden"})}}},{key:"_renderHistogram",value:function(){for(var t=this,i=this._options.histogramBarSpace,e=(this._rootWidth-i*(this._options.histogramBarCount-1))/this._options.histogramBarCount,s=Math.min.apply(null,this._data),o=(Math.max.apply(null,this._data)-Math.min.apply(null,this._data))/this._options.histogramBarCount,r=[],a=0;a<this._options.histogramBarCount;a++)!function(i){var e=i*o+s,a=e+o,n=t._data.filter(function(t){return t>=e&&t<=a}).length;r.push(n)}(a);for(var n=this._rootHeight/Math.max.apply(null,r),l="",a=0;a<this._options.histogramBarCount;a++){var h=r[a]*n;l+='<path class="sparkliner__histogram-bar" data-bar-value="('+(s+a*o).toFixed(1)+"-"+(o+s+a*o).toFixed(1)+"):"+r[a]+'" d="\n                M'+a*(e+i)+" "+this._rootHeight+" \n                L"+a*(e+i)+" "+(this._rootHeight-h)+" \n                L"+(a*(e+i)+e)+" "+(this._rootHeight-h)+" \n                L"+(a*(e+i)+e)+" "+this._rootHeight+' \n            Z" />'}var d='<svg class="sparkliner" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+l+"</svg>";this._root.innerHTML=d,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName){var s=e.getAttribute("data-bar-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderProgressGradient",value:function(){var t=this,i=void 0,e=void 0;!Array.isArray(this._data)&&this._data<=100?(i=this._data,e=100):Array.isArray(this._data)&&2===this._dataLen&&this._data[0]<this._data[1]&&(i=this._data[0],e=this._data[1]);var s=i/e*this._rootWidth,o='\n        <line class="sparkliner__progressgradient-line" data-progress-value="'+i+" / "+e+'" x1="'+s+'" y1="'+(this._rootHeight+this._options.progressGradientLineOverflow)+'" x2="'+s+'" y2="'+-this._options.progressGradientLineOverflow+'" />\n        <text class="sparkliner__progressgradient-text" data-progress-value="'+i+" / "+e+'" x="'+this._rootWidth/2+'" y="'+this._rootHeight/2+'" text-anchor="middle" alignment-baseline="middle" dominant-baseline="middle" >'+(i/e*100).toFixed(2)+"%</text>\n        ",r='<svg class="sparkliner sparkliner__progressgradient" data-progress-value="'+i+" / "+e+'" style="overflow:visible" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+o+"</svg>";this._root.innerHTML=r,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("svg"==e.tagName||"line"==e.tagName||"text"==e.tagName){var s=e.getAttribute("data-progress-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderProgressStep",value:function(){var t=this,i=void 0,e=void 0;!Array.isArray(this._data)&&this._data<=100?(i=this._data,e=100):Array.isArray(this._data)&&2===this._dataLen&&this._data[0]<this._data[1]&&(i=this._data[0],e=this._data[1]);var s=i/e*this._rootWidth,o='\n            <path class="sparkliner__progressstep-complete" data-progress-value="'+i+" / "+e+'" d="M0 0 L0 '+this._rootHeight+" L"+s+" "+this._rootHeight+" L"+s+' 0 Z" />\n            <path class="sparkliner__progressstep-incomplete" data-progress-value="'+i+" / "+e+'" d="M'+s+" 0 L"+s+" "+this._rootHeight+" L"+this._rootWidth+" "+this._rootHeight+" L"+this._rootWidth+' 0 Z" />\n            <line class="sparkliner__progressstep-line" data-progress-value="'+i+" / "+e+'" x1="'+s+'" y1="'+(this._rootHeight+this._options.progressStepLineOverflow)+'" x2="'+s+'" y2="'+-this._options.progressStepLineOverflow+'" />\n            <text class="sparkliner__progressstep-text" data-progress-value="'+i+" / "+e+'" x="'+this._rootWidth/2+'" y="'+this._rootHeight/2+'" text-anchor="middle" alignment-baseline="middle" dominant-baseline="middle" >'+(100*i/e).toFixed(2)+"%</text>\n        ",r='<svg class="sparkliner" style="overflow:visible" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+o+"</svg>";this._root.innerHTML=r,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName||"line"==e.tagName||"text"==e.tagName){var s=e.getAttribute("data-progress-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}},{key:"_renderProgressCircle",value:function(){var t=this,i=this._rootHeight/2,e=void 0,s=void 0;!Array.isArray(this._data)&&this._data<=100?(e=100==this._data?e=99.9999:this._data,s=100):Array.isArray(this._data)&&2===this._dataLen&&this._data[0]<=this._data[1]&&(e=100==this._data[0]?e=99.9999:this._data[0],s=this._data[1]);var o=e/s*2*Math.PI,r=this._rootWidth/2+i,a=this._rootHeight/2,n=r+i*Math.cos(Math.PI/2-o),l=a+i*-Math.sin(Math.PI/2-o),h='\n            <text class="sparkliner__circle-text" data-circle-value="'+e+" / "+s+'" x="'+(this._rootWidth/2-3)+'" y="'+this._rootHeight/2+'" text-anchor="end" alignment-baseline="middle" dominant-baseline="middle">\n                '+(100*e/s).toFixed(1)+'%\n            </text>\n            <circle class="sparkliner__circle-incomplete" data-circle-value="'+e+" / "+s+'" cx="'+r+'" cy="'+a+'" r="'+i+'"/>\n            <path class="sparkliner__circle-complete" data-circle-value="'+e+" / "+s+'" \n                d="M'+r+",0\n                A"+i+","+i+" 0 "+(o<=Math.PI?"0,1":"1,1")+" "+n+","+l+" \n                L"+r+","+a+' \n                Z" \n            />\n        ',d='<svg class="sparkliner" style="overflow:visible" height="'+this._rootHeight+'" width="'+this._rootWidth+'">'+h+"</svg>";this._root.innerHTML=d,this._options.showTooltips&&(this._root.addEventListener("mousemove",function(i){var e=i.target;if("path"==e.tagName||"circle"==e.tagName||"text"==e.tagName){var s=e.getAttribute("data-circle-value");t._tooltip.innerText=s,t._tooltip.style.visibility="visible"}else t._tooltip.style.visibility="hidden"}),this._root.addEventListener("mouseleave",function(){t._tooltip.style.visibility="hidden"}))}}]),t}(),refBars1=document.getElementById("root-bars");new sparkLiner(refBars1,[4,-4,6,3,4,-5,7,3],"bars");var refBars2=document.getElementById("root-dots");new sparkLiner(refBars2,[4,-4,6,3,4,-5,7,3],"dots");var refBars3=document.getElementById("root-polygon");new sparkLiner(refBars3,[4,-4,6,3,4,-5,7,3],"polygon");var refBars4=document.getElementById("root-hist");new sparkLiner(refBars4,[1,1,3,3,3,4,5,7,7,9,9,9],"histogram");var refBars5=document.getElementById("root-progressgradient");new sparkLiner(refBars5,[5,6],"progressgradient");var refBars6=document.getElementById("root-progressstep");new sparkLiner(refBars6,[2.5,12],"progressstep");var refBars7=document.getElementById("root-circle");new sparkLiner(refBars7,[37,88],"progresscircle");